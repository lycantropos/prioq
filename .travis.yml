dist: xenial

language: python

matrix:
  include:
    - python: pypy3.5-6.0.0
    - python: pypy3.6-7.0.0
    - python: 3.5
    - python: 3.6
    - python: 3.7
    - python: 3.8

install:
  - python -m pip install --upgrade pip setuptools
  - python -m pip install --upgrade codecov
  - python -m pip install --force-reinstall -r requirements.txt
  - python -m pip install --force-reinstall -r requirements-tests.txt

script:
  - pytest
  - python -m doctest README.md

after_success:
  - python -m codecov -f coverage.xml -X gcov

deploy:
  provider: pypi
  on:
    branch: master
    python: 3.5
  user: __token__
  password:
    secure: rZNiNUyG+1W9DHAIiT0NYUnhA4gJ1V3wTM6Ejja1UT2vv0LQg2T+ApBv//7B3Dbs1IGJQ8fmcLlX//eoFfUdI7bLHX3b/LC4l77G3+LZ9go192EGgbDrIF5iZLYIFlmNyQbqXnY2fRT0vjtPfg9EjCn+e+goVF79ky1cBhtbHGmVFJXr5Xt6lKu3sls4HihgiUgUHk1BBFH4GKQaTNkdzXoWoyEmWGDQKBBOwG4fuzEPS6bDkxzYKa3HNvqxgvFTrrzfajGtrTjVoE3B5pxQ8utM2SiRwpL1G7k9SUUl0W7HnQ3AmMcGyELV7NaoJf18BnY6rcrJbQI0EuJh+5qgfxUcQXMML6wVuUc0nL4wBwrU/uwTeg0Xo7XPGzySQoAA7tzjFnX5YvKF0IO1leKEU2+EWQVpLyCH7YftDpHzu8rkskGrl9bMmMStaUzziyOFkwcOc2qn2BU8B5cU6RIBypljzPxOC5Ozr+MCU8ErgX20UupGXf1iqBVGK4SL8OGykyL7e66zNH9+KuA4Mb3jaTB439mfv2zybjcC3enQQFS5Diz6xKi+ahEGsslpR5lz3do+M00Xu5+97onD7TtgmWovaleR5Sp9Zp2xGH9a/0sa9hTeLqoYhjwDDfUMT1z3G+7NinA5xDezl6sF9DHY9O12/2K8SbK7W3DVwT5uhxM=
  distributions: sdist bdist_wheel
  skip_existing: true
